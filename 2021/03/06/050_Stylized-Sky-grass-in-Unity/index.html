<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@100..900&display=swap" rel="stylesheet">
    <meta name="description" content="Sky: Children of the Light is one of my favorite games I am playing recently. During the pandemic, it is a great place where we are able to meet people (or even friends) from all over the world. Beyon">
<meta property="og:type" content="article">
<meta property="og:title" content="Making Sky&#39;s Stylized Grass with Compute Shader in Unity">
<meta property="og:url" content="https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/index.html">
<meta property="og:site_name" content="forkercat.blog">
<meta property="og:description" content="Sky: Children of the Light is one of my favorite games I am playing recently. During the pandemic, it is a great place where we are able to meet people (or even friends) from all over the world. Beyon">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/cyod1.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/niyql.JPG">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/2jp8m.gif">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/twin1.jpg">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/5c7ag.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/44sn3.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/8tx4z.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/h16u4.gif">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/j1w4w.gif">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/paz32.gif">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/usb0f.gif">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/vfeyh.png">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/641jj.gif">
<meta property="og:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/sypqs.png">
<meta property="article:published_time" content="2021-03-07T01:47:30.000Z">
<meta property="article:modified_time" content="2024-02-25T18:09:03.214Z">
<meta property="article:author" content="Junhao Wang">
<meta property="article:tag" content="Unity">
<meta property="article:tag" content="Grass">
<meta property="article:tag" content="Shader">
<meta property="article:tag" content="Compute Shader">
<meta property="article:tag" content="Sky">
<meta property="article:tag" content="URP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/cyod1.png">
    
    
      
        
          <link rel="shortcut icon" href="/resources/favicon/me/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/resources/favicon/me/android-chrome-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/resources/favicon/me/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Making Sky&#39;s Stylized Grass with Compute Shader in Unity</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-146643833-1"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-146643833-1');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.1.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Posts</a></li><!--
     --><!--
       --><li><a href="/studynotes/">Notes</a></li><!--
     --><!--
       --><li><a href="/lc/">Leetcode</a></li><!--
     --><!--
       --><li><a href="/games/">Games</a></li><!--
     --><!--
       --><li><a href="/links/">Links</a></li><!--
     --><!--
       --><li><a href="/about/">Me</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2024/02/25/051_using_emacs_keybindings_not_emacs/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2019/11/12/049_Understand%20Interface%20and%20Abstract%20Class%20in%20Java/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&text=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&title=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&is_video=false&description=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Making Sky&#39;s Stylized Grass with Compute Shader in Unity&body=Check out this article: https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&title=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&title=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&title=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&title=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&name=Making Sky&#39;s Stylized Grass with Compute Shader in Unity&description=&lt;p&gt;&lt;a href=&#34;https://thatskygame.com/&#34;&gt;Sky: Children of the Light&lt;/a&gt; is one of my favorite games I am playing recently. During the pandemic, it is a great place where we are able to meet people (or even friends) from all over the world. Beyond the plot, music, and cosmetics, I enjoyed every second when I was sliding on those beautiful lands, especially the stylized grass on top of them. In this post, I will share my experience in reproducing the grass in Unity under Universal Render Pipeline (v7.5.3). You will get result like the following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/cyod1.png&#34; alt=&#34;Sky&amp;#39;s Stylized Grass in Unity&#34;&gt;&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&t=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#How-To-Set-Up-TL-DR"><span class="toc-number">1.</span> <span class="toc-text">How To Set Up (TL;DR)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Usage"><span class="toc-number">1.1.</span> <span class="toc-text">Usage</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Painter-Tool"><span class="toc-number">2.</span> <span class="toc-text">Painter Tool</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Compute-Shader"><span class="toc-number">3.</span> <span class="toc-text">Compute Shader</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Learning-Resources"><span class="toc-number">3.1.</span> <span class="toc-text">Learning Resources</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rendering-Workflow"><span class="toc-number">3.2.</span> <span class="toc-text">Rendering Workflow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compute-Shader-Setup"><span class="toc-number">3.3.</span> <span class="toc-text">Compute Shader Setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Grass-Texture-Plane"><span class="toc-number">3.4.</span> <span class="toc-text">Grass Texture Plane</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Size-Variations"><span class="toc-number">3.4.1.</span> <span class="toc-text">Size Variations</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Wind"><span class="toc-number">3.4.2.</span> <span class="toc-text">Wind</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Interactivity"><span class="toc-number">3.4.3.</span> <span class="toc-text">Interactivity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LOD"><span class="toc-number">3.4.4.</span> <span class="toc-text">LOD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Combined"><span class="toc-number">3.4.5.</span> <span class="toc-text">Combined</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Renderer-Setup"><span class="toc-number">3.5.</span> <span class="toc-text">Renderer Setup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vertex-Shader"><span class="toc-number">4.</span> <span class="toc-text">Vertex Shader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fragment-Shader"><span class="toc-number">5.</span> <span class="toc-text">Fragment Shader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Other-Stuff"><span class="toc-number">6.</span> <span class="toc-text">Other Stuff</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Performance"><span class="toc-number">6.1.</span> <span class="toc-text">Performance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Known-Issues"><span class="toc-number">6.2.</span> <span class="toc-text">Known Issues</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References-Credits"><span class="toc-number">7.</span> <span class="toc-text">References &amp; Credits</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        <header id="header">
  <a class="u-url u-uid" href="/">
  
    
      <img id="logo" alt class="u-logo" src="/resources/images/me_avatar.jpg" />
    
  
    <div id="title">
      <h1 class="p-name">forkercat.blog</h1>
    </div>
  </a>
  <div id="nav">
    <ul>
      <li class="icon">
        <a href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-2x"></i></a>
      </li>
      <!--
     --><li><a href="/">Home</a></li><!--
   --><!--
     --><li><a href="/archives/">Posts</a></li><!--
   --><!--
     --><li><a href="/studynotes/">Notes</a></li><!--
   --><!--
     --><li><a href="/lc/">Leetcode</a></li><!--
   --><!--
     --><li><a href="/games/">Games</a></li><!--
   --><!--
     --><li><a href="/links/">Links</a></li><!--
   --><!--
     --><li><a href="/about/">Me</a></li><!--
   -->
    </ul>
  </div>
</header>

        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Making Sky&#39;s Stylized Grass with Compute Shader in Unity
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Junhao Wang</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-03-07T01:47:30.000Z" class="dt-published" itemprop="datePublished">2021-03-06</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/Unity/">Unity</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/Compute-Shader/" rel="tag">Compute Shader</a>, <a class="p-category" href="/tags/Grass/" rel="tag">Grass</a>, <a class="p-category" href="/tags/Shader/" rel="tag">Shader</a>, <a class="p-category" href="/tags/Sky/" rel="tag">Sky</a>, <a class="p-category" href="/tags/URP/" rel="tag">URP</a>, <a class="p-category" href="/tags/Unity/" rel="tag">Unity</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p><a target="_blank" rel="noopener" href="https://thatskygame.com/">Sky: Children of the Light</a> is one of my favorite games I am playing recently. During the pandemic, it is a great place where we are able to meet people (or even friends) from all over the world. Beyond the plot, music, and cosmetics, I enjoyed every second when I was sliding on those beautiful lands, especially the stylized grass on top of them. In this post, I will share my experience in reproducing the grass in Unity under Universal Render Pipeline (v7.5.3). You will get result like the following:</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/cyod1.png" alt="Sky&#39;s Stylized Grass in Unity"></p>
<span id="more"></span>

<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/niyql.JPG" alt="Stylized Grass in Sky: Children of the Light (in-game screenshot)"></p>
<p>Be aware that this post is not a tutorial, but you will find all the information you need from attached references (tutorial blogs, YouTube videos, etc) and the comments I wrote in source files. Unusually, I decided to use compute shaders because I develop on Metal API and it does not support geometry shaders. Don’t worry! It is much easier to implement the same effect in a geometry shader (less 1,000 lines of code I believe).</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/2jp8m.gif" alt="Reproduce Sky&#39;s Stylized Grass in Unity"></p>
<h2 id="How-To-Set-Up-TL-DR"><a href="#How-To-Set-Up-TL-DR" class="headerlink" title="How To Set Up (TL;DR)"></a>How To Set Up (TL;DR)</h2><p>You can use the shaders and scripts I wrote right away. To make the shaders more usable in games, I paint the grass with the help of the <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=xKJHL8nQiuM&ab_channel=MinionsArt">painter tool</a> made by MinionsArt. Check out the website if you are interested in learning how the tool works from behind. I made some changes to the two original files to add shortcut and compute shader support.</p>
<h3 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h3><ol>
<li>Download three shader files<ol>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrass-shader">SkylikeGrass.shader</a> (shader file)</li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrass-hlsl">SkylikeGrass.hlsl</a> (main shader logic that contains <code>vertex</code> and <code>fragment</code> functions)</li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrasscompute-compute">SkylikeGrassCompute.compute</a> (compute shader)</li>
</ol>
</li>
<li>Create two materials that use <code>Grass/SkylikeGrass</code> shader.<ol>
<li><code>SkylikeStripMaterial</code> and set the <a target="_blank" rel="noopener" href="https://github.com/forkercat/StorageBaseWithoutCatNotice/blob/main/grass_strip.png">strip texture</a></li>
<li><code>SkylikeCircleMaterial</code> and set the <a target="_blank" rel="noopener" href="https://github.com/forkercat/StorageBaseWithoutCatNotice/blob/main/grass_circle_blur.png">circle texture</a></li>
<li>After importing texture files, go to inspector:<ol>
<li>Check <code>Alpha Is Transparency</code></li>
<li>Set <code>Wrap Mode</code> to <code>Clamp</code></li>
</ol>
</li>
</ol>
</li>
<li>Set up painter tool and renderer<ol>
<li>Download <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrasspainter-cs">SkylikeGrassPainter.cs</a> and import</li>
<li>Download <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrasspaintereditor-cs">SkylikeGrassPainterEditor.cs</a> and put it to <code>Assets/Editor</code></li>
<li>Download <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrasscomputerenderer-cs">SkylikeGrassComputeRenderer.cs</a> and import</li>
</ol>
</li>
<li>Set up painting<ol>
<li>Create a plane where the painter tool draws on</li>
<li>Create an empty game object<ol>
<li>Add <code>SkylikeGrassPainter</code> script component</li>
<li>Add <code>SkylikeGrassComputeRenderer</code> script component</li>
<li>Manually set material and compute shader accordingly</li>
</ol>
</li>
</ol>
</li>
<li>Start painting!<ol>
<li>Make sure the empty game object is selected</li>
<li>Paint grass by holding any modifier key (e.g. <code>Shift</code>, <code>Ctrl</code>) and <code>right mouse button</code></li>
<li>Switch tool with any modifier key (e.g. <code>Shift</code>, <code>Ctrl</code>) and <code>middle mouse button</code></li>
</ol>
</li>
</ol>
<p>Hope you are enjoy this shader in your game! To get rid of setup overhead, it would be convenient if you prefab the empty object with a particular material, then next time you just drag the prefab to the scene to start painting. All the presets will be stored.</p>
<p>In addition, if you want to bring in interactive effect, download <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-shaderinteractor-cs">ShaderInteractor.cs</a> and attach it to your player object. You can find the original file from MinionsArt’s website as well.</p>
<h2 id="Painter-Tool"><a href="#Painter-Tool" class="headerlink" title="Painter Tool"></a>Painter Tool</h2><p>The painter tool is defined in <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrasspainter-cs">SkylikeGrassPainter.cs</a> and <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrasspaintereditor-cs">SkylikeGrassPainterEditor.cs</a>. Whenever you plant some grass on the ground, it will create a new mesh and store vertices which contain the information needed in our compute shader. Then this mesh will be accessed from <code>SkylikeGrassComputeRenderer</code> which uploads the data to compute shader. At the end of <code>SkylikeGrassPainter</code>, there are few lines doing the mesh work.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// set all info to mesh</span></span><br><span class="line">mesh = <span class="keyword">new</span> Mesh();</span><br><span class="line">mesh.name = <span class="string">&quot;Grass Mesh - &quot;</span> + name;</span><br><span class="line">mesh.SetVertices(positions);</span><br><span class="line">indi = indices.ToArray();</span><br><span class="line">mesh.SetIndices(indi, MeshTopology.Points, <span class="number">0</span>);</span><br><span class="line">mesh.SetUVs(<span class="number">0</span>, grassSizeMultipliers);</span><br><span class="line">mesh.SetColors(colors);</span><br><span class="line">mesh.SetNormals(normals);</span><br><span class="line">filter.mesh = mesh;</span><br></pre></td></tr></table></figure>

<p><code>MeshTopology.Points</code> indicates that the program will treat vertices individually. This makes sense since grass only spawns on a particular location.</p>
<p>Beside vertices, we store size multipliers inside UV0 (channel 0). This <code>Vector2</code> allows us to assign particular size to each vertex. Therefore, without changing the grass size in <code>SkylikeGrassComputeRenderer</code>, we can use the painter tool to vary grass size easily. This applies to grass color as well.</p>
<p>Again, to know more about the tool, please check out MinionsArt’s website.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.patreon.com/posts/geometry-grass-46836032">Geometry Grass Shader + Tool video + update</a> (by MinionsArt)</li>
</ul>
<h2 id="Compute-Shader"><a href="#Compute-Shader" class="headerlink" title="Compute Shader"></a>Compute Shader</h2><h3 id="Learning-Resources"><a href="#Learning-Resources" class="headerlink" title="Learning Resources"></a>Learning Resources</h3><p>Compute shaders provide the possibility that we can send processing tasks from CPU to GPU. These tasks include but is not limited to procedural generation (e.g. terrain creation), physics simulation, etc. In our case, we use them to replace the role of geometry shader in the graphics pipeline. Compute buffers are the places where these two processing units communicate data. We will define some data structures here.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/twin1.jpg" alt="Comparison between CPU and GPU (source is attached)"></p>
<p>There are a bunch of great tutorials regarding compute shaders. I recommend going over the following videos in order to have a conceptual and practical overview of this technique.</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://youtu.be/BrZ4pWwkpto">Getting Started with Compute Shaders in Unity</a> (by Game Dev Guide)</li>
<li><a target="_blank" rel="noopener" href="https://youtu.be/EB5HiqDl7VE">Intro to Compute Shaders in Unity URP! Replace Geometry Shaders</a> (by NedMakesGames)</li>
</ol>
<p>From the first video, you basically learn what compute shader is and how it works. From the second one, it is more like a step-by-step tutorial that teaches you to create an interesting effect. The author also made several follow-up videos on using compute shaders in practice.</p>
<p>To be honest, once you have done the second one, you will find the setup very intimidating. Unlike using geometry shaders, everything has to be defined manually, which makes the code a bit lengthy and tedious. Also, during the procress you have to be careful, because it could be difficult to find out why it does not work. From my experience in Unity 2019 4.18 f1, it makes Unity crash more frequently as well. </p>
<p>Therefore, one tip is that if you execute the renderer script in <code>[ExecuteInEditMode]</code> every time before you update the script you’d better disable the object first and enable it after you believe the code is right.</p>
<h3 id="Rendering-Workflow"><a href="#Rendering-Workflow" class="headerlink" title="Rendering Workflow"></a>Rendering Workflow</h3><p>Once you are familiar with compute shaders, it is time to apply them to actual usage. Let us first recall what the rendering flow looks like if you use the geometry shader. Data from a mesh is uploaded to GPU’s buffers and gets passed down from vertex shaders to fragment shaders. Actually there are other shaders in between but here we just ignore them for now. The geometry shader is placed in the middle.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/5c7ag.png" alt="Rendering Workflow with Geometry Shaders"></p>
<p>However, if we use compute shaders to implement the same functionality, the ordering is quite different. In this case, the compute shader goes first. We use C# script to upload mesh data from CPU to GPU and to trigger the compute shader to start processing the data. This data will then be stored in a specific compute buffer from which the vertex shader can read the processed data (vertices and triangles). Compute Shaders are not placed between vertex and fragment shaders.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/44sn3.png" alt="Rendering Workflow with Compute Shaders"></p>
<p>As a novice to this topic, I felt confused because I did not notice the difference and still had the original workflow in my mind. Again, once you notice the difference, you will understand why those data structures in compute buffers are defined in such ways.</p>
<h3 id="Compute-Shader-Setup"><a href="#Compute-Shader-Setup" class="headerlink" title="Compute Shader Setup"></a>Compute Shader Setup</h3><p><strong>[Source Code]</strong> <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrasscompute-compute">SkylikeGrassCompute.compute</a></p>
<p>To write a compute shader for our grass, we first need to define some structures to manage the data. Again, if you find something not being described here, please go through the two videos about compute shaders first!</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> SourceVertex</span><br><span class="line">&#123;</span><br><span class="line">    float3 positionOS;</span><br><span class="line">    float3 normalOS;</span><br><span class="line">    float2 uv;      <span class="comment">// widthMultiplier, heightMultiplier</span></span><br><span class="line">    float3 color;   <span class="comment">// brush color</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> DrawVertex</span><br><span class="line">&#123;</span><br><span class="line">    float3 positionWS;</span><br><span class="line">    float2 uv;</span><br><span class="line">    float3 brushColor;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> DrawTriangle</span><br><span class="line">&#123;</span><br><span class="line">    float3 normalOS;</span><br><span class="line">    float3 pivotWS;         <span class="comment">// for billboard effect</span></span><br><span class="line">    DrawVertex vertices[<span class="number">3</span>]; <span class="comment">// three points on the triangle</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p> <code>SourceVertex</code> represents the data from the mesh (remember the mesh is created by the painter tool). <code>DrawVertex</code> and <code>DrawTriangle</code> represent the data generated from this compute shader and they should be redefined in the vertex shader. Then we have the buffers as follows:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">StructuredBuffer&lt;SourceVertex&gt;       _SourceVertices;</span><br><span class="line">AppendStructuredBuffer&lt;DrawTriangle&gt; _DrawTriangles;</span><br></pre></td></tr></table></figure>

<p>After that, we define some variables before writing the kernel function. They will be set up by the renderer script.</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span>      _NumSourceVertices;</span><br><span class="line">float4x4 _LocalToWorld;  <span class="comment">// UNITY_MATRIX_M</span></span><br><span class="line"><span class="type">float</span>    _CurrentTime;   <span class="comment">// _Time</span></span><br></pre></td></tr></table></figure>

<p>Note that in a compute shader we cannot access many built-in shader variables and functions such as <code>_Time</code>, <code>UNITY_MATRIX_M</code>, etc. We have to define them by ourselves and set them via C# scripts. It is a mistake you might make. Therefore, I recommend not including these <code>.hlsl</code> files at the first place. If you plan to use them, make sure the variables or functions you use are supported in compute shaders.</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#include &quot;Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl&quot;</span></span><br><span class="line"><span class="meta">#include &quot;Packages/com.unity.render-pipelines.universal/ShaderLibrary/Lighting.hlsl&quot;</span></span><br><span class="line"><span class="meta">#include &quot;Packages/com.unity.render-pipelines.universal/ShaderLibrary/Shadows.hlsl&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Grass-Texture-Plane"><a href="#Grass-Texture-Plane" class="headerlink" title="Grass Texture Plane"></a>Grass Texture Plane</h3><p>Before moving to the renderer section, let us understand how to draw the triangles needed to hold the grass texture.</p>
<p>If you are new to shader scripts, I suggest going over the following tutorials:</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://www.cyanilux.com/tutorials/intro-to-shaders/">Intro to Shaders</a> (by Cyanilux)</li>
<li><a target="_blank" rel="noopener" href="https://roystan.net/articles/grass-shader.html">Grass Shader</a> (by Roystan)</li>
<li><a target="_blank" rel="noopener" href="https://github.com/Unity-Technologies/Graphics/tree/master/com.unity.render-pipelines.universal/Shaders">Unity URP Shader Examples</a></li>
</ol>
<p>The first one teaches you HLSL shaders from scratch, while the second one is a good practical tutorial to help you get more familiar with shader scripts and geometry shader (but it is not written for URP).  Unity URP shader examples are also a great place where you can find answers to your questions.</p>
<p>To display a texture, we need two triangles to make up a plane to hold the texture. At the end of the shader, we append these two triangles (six vertices) to <code>_DrawTriangles</code> buffer.</p>
<h4 id="Size-Variations"><a href="#Size-Variations" class="headerlink" title="Size Variations"></a>Size Variations</h4><p>Texture size is defined by <code>_TexWidth</code> and <code>_TexHeight</code>. The size can further be changed by two ways: </p>
<ol>
<li>Multipliers from painter brush</li>
<li>Randomness</li>
</ol>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">_TexWidth *= sv.uv.x;   <span class="comment">// width multiplier</span></span><br><span class="line">_TexHeight *= sv.uv.y;  <span class="comment">// height multiplier</span></span><br><span class="line"></span><br><span class="line">_TexWidth *= <span class="built_in">clamp</span>(rand(sv.positionOS.zyx), <span class="number">1</span> - _TexRandomWidth, <span class="number">1</span> + _TexRandomWidth);</span><br><span class="line">_TexHeight *= <span class="built_in">clamp</span>(rand(sv.positionOS.xyz), <span class="number">1</span> - _TexRandomHeight, <span class="number">1</span> + _TexRandomHeight);</span><br><span class="line"><span class="comment">// for uniform size</span></span><br><span class="line"><span class="type">float</span> sizeMultiplier = <span class="built_in">clamp</span>(rand(sv.positionOS.yxz), <span class="number">1</span> - _TexRandomSize, <span class="number">1</span> + _TexRandomSize);</span><br><span class="line">_TexWidth *= sizeMultiplier;</span><br><span class="line">_TexHeight *= sizeMultiplier;</span><br></pre></td></tr></table></figure>

<p>Vertex positions are defined by <code>_TexFloatHeight</code>, size, and absolute world directions (<code>world up</code>, <code>world right</code>). Rotating the object does not affect the rotation of grass.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/8tx4z.png" alt="Triangles on Different Types of Surfaces"></p>
<h4 id="Wind"><a href="#Wind" class="headerlink" title="Wind"></a>Wind</h4><p>To apply swaying effect on grass, vertex positions are changed based on <code>_CurrentTime</code>. However, rather than using absolute world directions, we go with directions based on the surface (something like the basis vectors in tangent space).</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/h16u4.gif" alt="Swaying on the Surface"></p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">float3 v0 = sv.positionOS.xyz;</span><br><span class="line">float2 windOffset = float2(<span class="built_in">sin</span>(_CurrentTime.x * _WindSpeed + v0.x)</span><br><span class="line">                               + <span class="built_in">sin</span>(_CurrentTime.x * _WindSpeed + v0.z * <span class="number">2</span>)</span><br><span class="line">                               + <span class="built_in">sin</span>(_CurrentTime.x * _WindSpeed * <span class="number">0.1</span> + v0.x),  <span class="comment">// right</span></span><br><span class="line">                           <span class="built_in">cos</span>(_CurrentTime.x * _WindSpeed + v0.x * <span class="number">2</span>)</span><br><span class="line">                               + <span class="built_in">cos</span>(_CurrentTime.x * _WindSpeed + v0.z));  <span class="comment">// forward</span></span><br><span class="line"><span class="type">float</span> windLeaningOffset = windOffset.x * _WindLeaningDist * <span class="number">0.01</span>;</span><br><span class="line">windOffset *= _WindStrength * <span class="number">0.1</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/j1w4w.gif" alt="Leaning Effect"></p>
<p>The variable <code>windLeaningOffset</code> controls the amount of distance that the grass leans. Currently it just leans randomly. If you are interested in making the effect that the grass leans towards the direction it moves, check out the code <a target="_blank" rel="noopener" href="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/0u3hh.png">here</a>. It is a bit tricky to get the actual moving direction because we will apply billboard effect to the grass in the vertex shader, which make it always face the camera.</p>
<h4 id="Interactivity"><a href="#Interactivity" class="headerlink" title="Interactivity"></a>Interactivity</h4><p>The code snippet comes from <a target="_blank" rel="noopener" href="https://www.patreon.com/posts/grass-geometry-1-40090373">here</a>. It is straightforward.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/paz32.gif" alt="Interactivity"></p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Interactivity</span></span><br><span class="line">float3 dis = <span class="built_in">distance</span>(_MovingPosition, positionWS);</span><br><span class="line">float3 radius = <span class="number">1</span> - saturate(dis / _InteractorRadius);</span><br><span class="line"><span class="comment">// in world radius based on objects interaction radius</span></span><br><span class="line">float2 interactorOffset = positionWS.xz - _MovingPosition.xz; <span class="comment">// position comparison</span></span><br><span class="line">interactorOffset *= radius; <span class="comment">// position multiplied by radius for falloff</span></span><br><span class="line"><span class="comment">// increase strength</span></span><br><span class="line">interactorOffset = <span class="built_in">clamp</span>(interactorOffset.xy * _InteractorStrength, <span class="number">-0.8</span>, <span class="number">0.8</span>);</span><br></pre></td></tr></table></figure>

<h4 id="LOD"><a href="#LOD" class="headerlink" title="LOD"></a>LOD</h4><p>Applying LOD is a great way to improve performance in a large outdoor environment. When the distance between the grass and the camera is greater than <code>_HideDistance</code>, the grass does not show up.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/usb0f.gif" alt="Level of Detail (LOD), Hide Distance = 20"></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">float3 positionWS = mul(_LocalToWorld, float4(sv.positionOS, <span class="number">1</span>)).xyz;</span><br><span class="line"><span class="built_in">float</span> distanceFromCamera = distance(positionWS, _CameraPositionWS);</span><br><span class="line"><span class="keyword">if</span> (distanceFromCamera &gt; _HideDistance)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Combined"><a href="#Combined" class="headerlink" title="Combined"></a>Combined</h4><p>With all the offset calculations above, it is ready to put them into a function and set up the output data.</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Generate each vertex for output triangles</span></span><br><span class="line">DrawVertex GenerateVertex(float3 positionWS, float3 rightDirWS, float3 forwardDirWS,</span><br><span class="line">                          <span class="type">float</span> startHeight, <span class="type">float</span> verticalOffset, <span class="type">float</span> horizonOffset,</span><br><span class="line">                          float2 windOffset, <span class="type">float</span> windLeaningOffset, float2 interactorOffset,</span><br><span class="line">                          float2 uv, float3 color)</span><br><span class="line">&#123;</span><br><span class="line">    DrawVertex output;</span><br><span class="line">    <span class="comment">// Position</span></span><br><span class="line">    positionWS += float3(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>) * (startHeight + verticalOffset);</span><br><span class="line">    positionWS += float3(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>) * horizonOffset;</span><br><span class="line">    <span class="comment">// Offset</span></span><br><span class="line">    positionWS += rightDirWS * (windOffset.x + windLeaningOffset - interactorOffset.x);</span><br><span class="line">    positionWS += forwardDirWS * (windOffset.y - interactorOffset.y);  <span class="comment">// forward</span></span><br><span class="line">    output.positionWS = positionWS;</span><br><span class="line">    <span class="comment">// UV</span></span><br><span class="line">    output.uv = uv;</span><br><span class="line">    <span class="comment">// Color</span></span><br><span class="line">    output.brushColor = color;</span><br><span class="line">    <span class="keyword">return</span> output;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> Main(uint3 id : SV_DispatchThreadID)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Bottom-Left Triangle</span></span><br><span class="line">    DrawTriangle tri = (DrawTriangle) <span class="number">0</span>;</span><br><span class="line">    tri.<span class="keyword">vertices</span>[<span class="number">0</span>] = GenerateVertex(positionWS, surfaceRightDirWS, surfaceForwardDirWS,</span><br><span class="line">                                    _TexFloatHeight, <span class="number">0</span>, -_TexWidth / <span class="number">2</span>, windOffset, -windLeaningOffset,</span><br><span class="line">                                    interactorOffset, float2(<span class="number">1</span>, <span class="number">0</span>), sv.color);</span><br><span class="line">    tri.<span class="keyword">vertices</span>[<span class="number">1</span>] = GenerateVertex(positionWS, surfaceRightDirWS, surfaceForwardDirWS,</span><br><span class="line">                                    _TexFloatHeight, <span class="number">0</span>, _TexWidth / <span class="number">2</span>, windOffset, -windLeaningOffset,</span><br><span class="line">                                    interactorOffset, float2(<span class="number">0</span>, <span class="number">0</span>), sv.color);</span><br><span class="line">    tri.<span class="keyword">vertices</span>[<span class="number">2</span>] = GenerateVertex(positionWS, surfaceRightDirWS, surfaceForwardDirWS,</span><br><span class="line">                                    _TexFloatHeight, _TexHeight, -_TexWidth / <span class="number">2</span>, windOffset, windLeaningOffset,</span><br><span class="line">                                    interactorOffset, float2(<span class="number">1</span>, <span class="number">1</span>), sv.color);</span><br><span class="line">    tri.normalWS = worldUp;</span><br><span class="line">    float3 pivotWS = (tri.<span class="keyword">vertices</span>[<span class="number">1</span>].positionWS + tri.<span class="keyword">vertices</span>[<span class="number">2</span>].positionWS) / <span class="number">2.0</span>;</span><br><span class="line">    tri.pivotWS = pivotWS;</span><br><span class="line">    _DrawTriangles.Append(tri);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Top-Right triangle</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="Renderer-Setup"><a href="#Renderer-Setup" class="headerlink" title="Renderer Setup"></a>Renderer Setup</h3><p><strong>[Source Code]</strong> <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrasscomputerenderer-cs">SkylikeGrassComputeRenderer.cs</a></p>
<p>At this time, we have finished writing the compute shader. Rather than using <code>MeshRenderer</code>, we write up our own renderer script to execute the task in the compute shader and trigger drawing methods.</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ExecuteInEditMode</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">SkylikeGrassComputeRenderer</span> : <span class="title">MonoBehaviour</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Structure</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">struct</span> SourceVertex</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> Vector3 position; <span class="keyword">public</span> Vector3 normal;</span><br><span class="line">        <span class="keyword">public</span> Vector2 uv;       <span class="keyword">public</span> Vector3 color;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Definitions of Buffers, Stride Constants, etc</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnValidate</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Set up components</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnEnable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Initialize</span></span><br><span class="line">        <span class="comment">// Set up buffer data and upload it to GPU</span></span><br><span class="line">        m_Initialized = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnDisable</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (m_Initialized)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// Release buffers</span></span><br><span class="line">            <span class="comment">// ...</span></span><br><span class="line">        &#125;</span><br><span class="line">        m_Initialized = <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">LateUpdate</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Refresh the output buffer</span></span><br><span class="line">        <span class="comment">// Update data (e.g. _CurrentTime, _LocalToWorld, etc)</span></span><br><span class="line">        <span class="comment">// Draw</span></span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Vertex-Shader"><a href="#Vertex-Shader" class="headerlink" title="Vertex Shader"></a>Vertex Shader</h2><p><strong>[Source Code]</strong> <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrass-shader">SkylikeGrass.shader</a>, <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrass-hlsl">SkylikeGrass.hlsl</a></p>
<p>Following the tutorial made by NedMakesGames, I found that splitting code into <code>.shader</code> and <code>.hlsl</code> files is a good way to organize lengthy shader code. In the <code>.shader</code> file, it mainly sets up SubShader, Pass, and enable keywords we need. In the <code>.hlsl</code> file, it first defines the buffer and structures we used before in the compute shader, which are <code>DrawVertex</code> and <code>DrawTriangle</code>. After that, it contains vertex and fragment functions.</p>
<p>Unlike many other vertex functions, in our case we retrieve the data by <code>SV_VertexID</code>. Once we have the data, we set it up in a <code>v2f</code> struct so the fragment function is able to retrieve the data it needs.</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v2f vert(<span class="type">uint</span> vertexID : SV_VertexID)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Initialize the output struct</span></span><br><span class="line">    v2f output;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get the vertex from the buffer</span></span><br><span class="line">    DrawTriangle tri = _DrawTriangles[vertexID / <span class="number">3</span>];</span><br><span class="line">    DrawVertex input = tri.<span class="keyword">vertices</span>[vertexID % <span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To achieve the billboard effect, we need to transform vertex positions such that the plane is always facing our main camera. There are already a bunch of methods existing on the Internet. I found the following video helpful.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=qGppGvgw7Dg&t=982s&ab_channel=Aperium">Unity Shader Tutorial - Billboard Shader</a> (by Aperium)</li>
</ul>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Billboard</span></span><br><span class="line">float4 pivotWS = float4(tri.pivotWS, <span class="number">1</span>);</span><br><span class="line">float4 pivotVS = mul(UNITY_MATRIX_V, pivotWS);</span><br><span class="line"></span><br><span class="line">float4 worldPos = float4(input.positionWS, <span class="number">1</span>);</span><br><span class="line">float4 flippedWorldPos = float4(<span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>) * (worldPos - pivotWS) + pivotWS;</span><br><span class="line">float4 viewPos = flippedWorldPos - pivotWS + pivotVS;</span><br><span class="line">output.positionCS = mul(UNITY_MATRIX_P, viewPos);</span><br></pre></td></tr></table></figure>

<p>This code is pretty much the same with the one in the video. The pivot position of the grass plane is calculated in the compute shader. </p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/vfeyh.png" alt="Calculate New View Position (ignore flipped world position)"></p>
<p>Personally, I did not completely understand all the detail, but I think it has something to do with the view matrix. It has changed what the matrix previously does such that it can rotate the grass plane towards us. Note that in the illustration it just ignores flipping, which is explained in the video. If you know this well, please teach me in the comment!</p>
<h2 id="Fragment-Shader"><a href="#Fragment-Shader" class="headerlink" title="Fragment Shader"></a>Fragment Shader</h2><p><strong>[Source Code]</strong> <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrass-shader">SkylikeGrass.shader</a>, <a target="_blank" rel="noopener" href="https://gist.github.com/forkercat/fb6c030c17fe1e109a34f1c92571943f#file-skylikegrass-hlsl">SkylikeGrass.hlsl</a></p>
<p>In fragment shader, base color is lerped between <code>_BaseColor</code> and <code>_TopColor</code> based on the Y texture coordinate. I use two colors here but you can definitely turn it into one only. By multiplying the result with brush color, we are able to override the color for each grass entity via the painter tool.</p>
<p>Both ambient and diffuse components contribute to final color. You can tweak ambient strength to make it look good in a night scene, then increase diffuse strength to what you want. Setting a larger diffuse color sometimes gives you better result if you have bloom effect enabled.</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Light mainLight = GetMainLight();</span><br><span class="line"></span><br><span class="line">float3 baseColor = lerp(_BaseColor, _TopColor, saturate(input.uv.y)) * input.brushColor;</span><br><span class="line"></span><br><span class="line">float3 ambient = baseColor * _AmbientStrength;</span><br><span class="line">float3 diffuse = baseColor * _DiffuseStrength;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> NdotL = <span class="built_in">max</span>(<span class="number">0</span>, <span class="built_in">dot</span>(mainLight.direction, input.normalWS));</span><br><span class="line">diffuse *= NdotL;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Combine</span></span><br><span class="line">float4 combined = float4(ambient + diffuse, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>If you watch the grass carefully in Sky, you should notice that the grass is highlighted when players tramping on top of it. It is a subtle effect but I found it very interesting and the implementation is not difficult once you have the speed percentage along the moving direction of your player object (<code>current speed</code> &#x2F; <code>max speed</code>).</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/641jj.gif" alt="Highlighted Grass in Sky: Children of the Light"></p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Interactor Highlight</span></span><br><span class="line"><span class="type">float</span> distFromMovingPosition = <span class="built_in">distance</span>(_MovingPosition, input.positionWS);</span><br><span class="line"><span class="keyword">if</span> (distFromMovingPosition &lt; _HighlightRadius)</span><br><span class="line">&#123;</span><br><span class="line">    combined.rgb *= (<span class="number">1</span> + _MovingSpeedPercent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>At this point, you should be able to see an opaque and rectangular plane swaying above the surface. To make it look better, we enable alpha testing and transparency in <code>.shader</code> file, sample the alpha channel of the texture, and multiply it with the combined RGB and alpha values.</p>
<p><img src="https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/sypqs.png" alt="Enable Transparency"></p>
<p>You can find the texture files at the beginning of this article. If you are a creative person, you can definitely create your own textures to make it more aesthetic.</p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Texture Mask Color (pure white + alpha)</span></span><br><span class="line">half4 texMaskColor = SAMPLE_TEXTURE2D(_BaseTex, sampler_BaseTex, input.uv);</span><br><span class="line"><span class="keyword">return</span> combined * texMaskColor;  <span class="comment">// I also multiply rgb values, but it is okay if it is pure white</span></span><br></pre></td></tr></table></figure>



<h2 id="Other-Stuff"><a href="#Other-Stuff" class="headerlink" title="Other Stuff"></a>Other Stuff</h2><h3 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h3><p>So far, I have not noticed any performance issue. Although after adding a huge amount of grass to the scene and even at the same time turning off LOD, there is no significant drop of FPS. I will follow up on that if I discover any issue.</p>
<h3 id="Known-Issues"><a href="#Known-Issues" class="headerlink" title="Known Issues"></a>Known Issues</h3><ol>
<li>Shadow cast does not work as expected. Currently I do not figure out why. It has some weird effect. If two renderers enable shadow cast at the same time, it starts blinking. However, for my game, I do not intend to enable shadow cast for now.</li>
<li>In Metal, the console sometimes pops up many warnings, which is annoying. Is it a bug? I haven’t not found a solution to that yet.</li>
</ol>
<p>Thanks for reading! If you like this grass, please let me know in the comment!</p>
<h2 id="References-Credits"><a href="#References-Credits" class="headerlink" title="References &amp; Credits"></a>References &amp; Credits</h2><ul>
<li>MinionsArt<ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=xKJHL8nQiuM&ab_channel=MinionsArt">Unity - I made an Interactive Grass Shader + Tool</a></li>
<li><a target="_blank" rel="noopener" href="https://www.patreon.com/posts/geometry-grass-46836032">Geometry Grass Shader + Tool video + update</a></li>
<li><a target="_blank" rel="noopener" href="https://www.patreon.com/posts/grass-geometry-1-40090373">Grass Geometry Shader with Interactivity (Part 1, the shader)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.patreon.com/posts/grass-geometry-2-40077798">Grass Geometry Shader with Interactivity (Part 2, the editor tool)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.patreon.com/posts/geometry-grass-47447321">Geometry Grass Shader for URP</a></li>
</ul>
</li>
<li>Ned Makes Game<ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=EB5HiqDl7VE&ab_channel=NedMakesGames">Intro to Compute Shaders in Unity URP! Replace Geometry Shaders</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=DeATXF4Szqo&ab_channel=NedMakesGames">Grass Fields in Unity URP! Generate Blades with Compute Shaders!</a></li>
</ul>
</li>
<li>Game Dev Guide: <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=BrZ4pWwkpto&ab_channel=GameDevGuide">Getting Started with Compute Shaders in Unity</a></li>
<li>Kyle Halladay: <a target="_blank" rel="noopener" href="http://kylehalladay.com/blog/tutorial/2014/06/27/Compute-Shaders-Are-Nifty.html">Getting Started With Compute Shaders In Unity</a></li>
<li>Cyanilux: <a target="_blank" rel="noopener" href="https://www.cyanilux.com/tutorials/intro-to-shaders/">Intro to Shaders</a></li>
<li>Roystan: <a target="_blank" rel="noopener" href="https://roystan.net/articles/grass-shader.html">Grass Shader</a></li>
<li>Unity-Technologies: <a target="_blank" rel="noopener" href="https://github.com/Unity-Technologies/Graphics/tree/master/com.unity.render-pipelines.universal/Shaders">URP Shader Examples</a></li>
<li>Aperium: <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=qGppGvgw7Dg&t=982s&ab_channel=Aperium">Unity Shader Tutorial - Billboard Shader</a></li>
</ul>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives/">Posts</a></li>
        
          <li><a href="/studynotes/">Notes</a></li>
        
          <li><a href="/lc/">Leetcode</a></li>
        
          <li><a href="/games/">Games</a></li>
        
          <li><a href="/links/">Links</a></li>
        
          <li><a href="/about/">Me</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#How-To-Set-Up-TL-DR"><span class="toc-number">1.</span> <span class="toc-text">How To Set Up (TL;DR)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Usage"><span class="toc-number">1.1.</span> <span class="toc-text">Usage</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Painter-Tool"><span class="toc-number">2.</span> <span class="toc-text">Painter Tool</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Compute-Shader"><span class="toc-number">3.</span> <span class="toc-text">Compute Shader</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Learning-Resources"><span class="toc-number">3.1.</span> <span class="toc-text">Learning Resources</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rendering-Workflow"><span class="toc-number">3.2.</span> <span class="toc-text">Rendering Workflow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Compute-Shader-Setup"><span class="toc-number">3.3.</span> <span class="toc-text">Compute Shader Setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Grass-Texture-Plane"><span class="toc-number">3.4.</span> <span class="toc-text">Grass Texture Plane</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Size-Variations"><span class="toc-number">3.4.1.</span> <span class="toc-text">Size Variations</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Wind"><span class="toc-number">3.4.2.</span> <span class="toc-text">Wind</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Interactivity"><span class="toc-number">3.4.3.</span> <span class="toc-text">Interactivity</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LOD"><span class="toc-number">3.4.4.</span> <span class="toc-text">LOD</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Combined"><span class="toc-number">3.4.5.</span> <span class="toc-text">Combined</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Renderer-Setup"><span class="toc-number">3.5.</span> <span class="toc-text">Renderer Setup</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vertex-Shader"><span class="toc-number">4.</span> <span class="toc-text">Vertex Shader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Fragment-Shader"><span class="toc-number">5.</span> <span class="toc-text">Fragment Shader</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Other-Stuff"><span class="toc-number">6.</span> <span class="toc-text">Other Stuff</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Performance"><span class="toc-number">6.1.</span> <span class="toc-text">Performance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Known-Issues"><span class="toc-number">6.2.</span> <span class="toc-text">Known Issues</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References-Credits"><span class="toc-number">7.</span> <span class="toc-text">References &amp; Credits</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&text=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&title=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&is_video=false&description=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Making Sky&#39;s Stylized Grass with Compute Shader in Unity&body=Check out this article: https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&title=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&title=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&title=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&title=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&name=Making Sky&#39;s Stylized Grass with Compute Shader in Unity&description=&lt;p&gt;&lt;a href=&#34;https://thatskygame.com/&#34;&gt;Sky: Children of the Light&lt;/a&gt; is one of my favorite games I am playing recently. During the pandemic, it is a great place where we are able to meet people (or even friends) from all over the world. Beyond the plot, music, and cosmetics, I enjoyed every second when I was sliding on those beautiful lands, especially the stylized grass on top of them. In this post, I will share my experience in reproducing the grass in Unity under Universal Render Pipeline (v7.5.3). You will get result like the following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://bloggg-1254259681.cos.na-siliconvalley.myqcloud.com/cyod1.png&#34; alt=&#34;Sky&amp;#39;s Stylized Grass in Unity&#34;&gt;&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://junhaow.com/2021/03/06/050_Stylized-Sky-grass-in-Unity/&t=Making Sky&#39;s Stylized Grass with Compute Shader in Unity"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    Junhao Wang
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'junhaow';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
